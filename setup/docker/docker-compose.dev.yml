name: benchback-dev

services:
  dev:
    build:
      context: ../..
      dockerfile: setup/docker/Dockerfile.dev
    runtime: nvidia
    user: "${UID:-1000}:${GID:-1000}"
    group_add:
      - "${DOCKER_GID:-999}"
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
    shm_size: '1gb'
    ulimits:
      memlock: -1
      stack: 67108864
    volumes:
      # Bind mount the entire workspace
      - ../..:/workspace
      # Mount Docker socket for Docker-in-Docker access
      - /var/run/docker.sock:/var/run/docker.sock
    # Keep container running
    stdin_open: true
    tty: true
